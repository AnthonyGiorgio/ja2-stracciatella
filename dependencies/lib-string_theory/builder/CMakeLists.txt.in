# @ONLY variables:
# CMAKE_BUILD_TYPE - which config to build
# CACHE_FILE - initial cache of the external project
# INSTALL_PREFIX - where to install the files generated by the external project
# CMAKELISTS_PATCHED_FILE - path to the patched CMakeLists.txt

cmake_minimum_required(VERSION 3.1)

project(builder NONE)

include(ExternalProject)
externalproject_add(string_theory
    URL "https://github.com/zrax/string_theory/archive/2.3.tar.gz"
    URL_MD5 "f0829240dc573efec01b75ebc9cbb12d"
    PATCH_COMMAND "${CMAKE_COMMAND}" -E copy_if_different "@CMAKELISTS_PATCHED_FILE@" CMakeLists.txt
    CMAKE_ARGS
        "-C@CACHE_FILE@"
        "-DCMAKE_INSTALL_PREFIX=@INSTALL_PREFIX@"
        -DST_BUILD_STATIC:BOOL=ON
        -DST_BUILD_TESTS:BOOL=OFF
    BUILD_COMMAND "${CMAKE_COMMAND}" --build . --config "@CMAKE_BUILD_TYPE@"
    INSTALL_COMMAND "${CMAKE_COMMAND}" --build . --config "@CMAKE_BUILD_TYPE@" --target install
)

